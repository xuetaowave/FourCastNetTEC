2024-02-17 17:02:37,574 - root - INFO - --------------- Versions ---------------
2024-02-17 17:02:37,581 - root - INFO - git branch: b'* master'
2024-02-17 17:02:37,584 - root - INFO - git hash: b'326ad32fb1280148646be8bf6c93cce0495a0f72'
2024-02-17 17:02:37,584 - root - INFO - Torch: 2.1.2+cu118
2024-02-17 17:02:37,584 - root - INFO - ----------------------------------------
2024-02-17 17:02:37,585 - root - INFO - ------------------ Configuration ------------------
2024-02-17 17:02:37,585 - root - INFO - Configuration file: /home/cxt/work/fourcastnet_TEC/FourCastNetTEC/config/AFNO.yaml
2024-02-17 17:02:37,585 - root - INFO - Configuration name: afno_backbone_tec_256
2024-02-17 17:02:37,585 - root - INFO - log_to_wandb False
2024-02-17 17:02:37,585 - root - INFO - lr 0.0005
2024-02-17 17:02:37,585 - root - INFO - batch_size 4
2024-02-17 17:02:37,585 - root - INFO - patch_size 4
2024-02-17 17:02:37,585 - root - INFO - depth 6
2024-02-17 17:02:37,585 - root - INFO - img_size [128, 256]
2024-02-17 17:02:37,585 - root - INFO - max_epochs 1500
2024-02-17 17:02:37,585 - root - INFO - scheduler CosineAnnealingLR
2024-02-17 17:02:37,585 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12]
2024-02-17 17:02:37,585 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12]
2024-02-17 17:02:37,585 - root - INFO - prediction_length 100
2024-02-17 17:02:37,585 - root - INFO - orography False
2024-02-17 17:02:37,585 - root - INFO - orography_path None
2024-02-17 17:02:37,585 - root - INFO - exp_dir /home/cxt/work/fourcastnet_TEC/FourCastNetTEC/results/tec_256
2024-02-17 17:02:37,585 - root - INFO - train_data_path /home/cxt/work/fourcastnet_TEC/FourCastNetTEC/Data_TEC_256x512/train
2024-02-17 17:02:37,585 - root - INFO - valid_data_path /home/cxt/work/fourcastnet_TEC/FourCastNetTEC/Data_TEC_256x512/test
2024-02-17 17:02:37,585 - root - INFO - inf_data_path /home/cxt/work/fourcastnet_TEC/FourCastNetTEC/Data_TEC_256x512/out_of_sample
2024-02-17 17:02:37,585 - root - INFO - time_means_path /home/cxt/work/fourcastnet_TEC/FourCastNetTEC/Data_TEC_256x512/time_means.npy
2024-02-17 17:02:37,585 - root - INFO - global_means_path /home/cxt/work/fourcastnet_TEC/FourCastNetTEC/Data_TEC_256x512/global_means.npy
2024-02-17 17:02:37,585 - root - INFO - global_stds_path /home/cxt/work/fourcastnet_TEC/FourCastNetTEC/Data_TEC_256x512/global_stds.npy
2024-02-17 17:02:37,585 - root - INFO - loss l2
2024-02-17 17:02:37,585 - root - INFO - num_data_workers 4
2024-02-17 17:02:37,585 - root - INFO - dt 1
2024-02-17 17:02:37,585 - root - INFO - n_history 0
2024-02-17 17:02:37,585 - root - INFO - prediction_type iterative
2024-02-17 17:02:37,586 - root - INFO - n_initial_conditions 5
2024-02-17 17:02:37,586 - root - INFO - ics_type default
2024-02-17 17:02:37,586 - root - INFO - save_raw_forecasts True
2024-02-17 17:02:37,586 - root - INFO - save_channel False
2024-02-17 17:02:37,586 - root - INFO - masked_acc False
2024-02-17 17:02:37,586 - root - INFO - maskpath None
2024-02-17 17:02:37,586 - root - INFO - perturb False
2024-02-17 17:02:37,586 - root - INFO - add_grid False
2024-02-17 17:02:37,586 - root - INFO - N_grid_channels 0
2024-02-17 17:02:37,586 - root - INFO - gridtype sinusoidal
2024-02-17 17:02:37,586 - root - INFO - roll False
2024-02-17 17:02:37,586 - root - INFO - num_blocks 8
2024-02-17 17:02:37,586 - root - INFO - nettype afno
2024-02-17 17:02:37,586 - root - INFO - width 56
2024-02-17 17:02:37,586 - root - INFO - modes 32
2024-02-17 17:02:37,586 - root - INFO - target default
2024-02-17 17:02:37,586 - root - INFO - normalization zscore
2024-02-17 17:02:37,586 - root - INFO - log_to_screen True
2024-02-17 17:02:37,586 - root - INFO - save_checkpoint True
2024-02-17 17:02:37,586 - root - INFO - enable_nhwc False
2024-02-17 17:02:37,586 - root - INFO - optimizer_type FusedAdam
2024-02-17 17:02:37,586 - root - INFO - crop_size_x None
2024-02-17 17:02:37,586 - root - INFO - crop_size_y None
2024-02-17 17:02:37,586 - root - INFO - two_step_training False
2024-02-17 17:02:37,586 - root - INFO - plot_animations False
2024-02-17 17:02:37,586 - root - INFO - add_noise False
2024-02-17 17:02:37,586 - root - INFO - noise_std 0
2024-02-17 17:02:37,586 - root - INFO - epsilon_factor 0
2024-02-17 17:02:37,586 - root - INFO - world_size 1
2024-02-17 17:02:37,587 - root - INFO - experiment_dir /home/cxt/work/fourcastnet_TEC/FourCastNetTEC/results/tec_256/afno_backbone_tec_256/d6
2024-02-17 17:02:37,587 - root - INFO - checkpoint_path /home/cxt/work/fourcastnet_TEC/FourCastNetTEC/results/tec_256/afno_backbone_tec_256/d6/training_checkpoints/ckpt.tar
2024-02-17 17:02:37,587 - root - INFO - best_checkpoint_path /home/cxt/work/fourcastnet_TEC/FourCastNetTEC/results/tec_256/afno_backbone_tec_256/d6/training_checkpoints/best_ckpt.tar
2024-02-17 17:02:37,587 - root - INFO - resuming False
2024-02-17 17:02:37,587 - root - INFO - local_rank 0
2024-02-17 17:02:37,587 - root - INFO - enable_amp True
2024-02-17 17:02:37,587 - root - INFO - name afno_backbone_tec_256_d6
2024-02-17 17:02:37,587 - root - INFO - group era5_precipafno_backbone_tec_256
2024-02-17 17:02:37,587 - root - INFO - project ERA5_precip
2024-02-17 17:02:37,587 - root - INFO - entity flowgan
2024-02-17 17:02:37,587 - root - INFO - ---------------------------------------------------
2024-02-17 17:02:37,591 - root - INFO - rank 0, begin data loader init
2024-02-17 17:02:37,592 - root - INFO - Getting file stats from /home/cxt/work/fourcastnet_TEC/FourCastNetTEC/Data_TEC_256x512/train/2005.h5
2024-02-17 17:02:37,592 - root - INFO - Number of samples per year: 336
2024-02-17 17:02:37,592 - root - INFO - Found data at path /home/cxt/work/fourcastnet_TEC/FourCastNetTEC/Data_TEC_256x512/train. Number of examples: 2352. Image Shape: 128 x 256 x 13
2024-02-17 17:02:37,592 - root - INFO - Delta t: 6 hours
2024-02-17 17:02:37,592 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2024-02-17 17:02:37,593 - root - INFO - Getting file stats from /home/cxt/work/fourcastnet_TEC/FourCastNetTEC/Data_TEC_256x512/test/2008.h5
2024-02-17 17:02:37,593 - root - INFO - Number of samples per year: 337
2024-02-17 17:02:37,593 - root - INFO - Found data at path /home/cxt/work/fourcastnet_TEC/FourCastNetTEC/Data_TEC_256x512/test. Number of examples: 674. Image Shape: 128 x 256 x 13
2024-02-17 17:02:37,593 - root - INFO - Delta t: 6 hours
2024-02-17 17:02:37,593 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2024-02-17 17:02:37,593 - root - INFO - rank 0, data loader initialized
2024-02-17 17:02:38,053 - root - INFO - Number of trainable model parameters: 32035584
2024-02-17 17:02:38,053 - root - INFO - Starting Training Loop...
2024-02-17 17:03:03,667 - root - INFO - Time taken for epoch 1 is 25.613348484039307 sec
2024-02-17 17:03:03,667 - root - INFO - Train loss: 0.2450135350227356. Valid loss: 0.34141236543655396
2024-02-17 17:03:28,474 - root - INFO - Time taken for epoch 2 is 24.80650019645691 sec
2024-02-17 17:03:28,474 - root - INFO - Train loss: 0.24035786092281342. Valid loss: 0.33742743730545044
2024-02-17 17:03:52,985 - root - INFO - Time taken for epoch 3 is 24.510529041290283 sec
2024-02-17 17:03:52,985 - root - INFO - Train loss: 0.2436976432800293. Valid loss: 0.3623630404472351
2024-02-17 17:04:17,492 - root - INFO - Time taken for epoch 4 is 24.506317377090454 sec
2024-02-17 17:04:17,492 - root - INFO - Train loss: 0.24392643570899963. Valid loss: 0.40480154752731323
2024-02-17 17:04:42,019 - root - INFO - Time taken for epoch 5 is 24.526736974716187 sec
2024-02-17 17:04:42,019 - root - INFO - Train loss: 0.24225357174873352. Valid loss: 0.42566990852355957
2024-02-17 17:05:06,547 - root - INFO - Time taken for epoch 6 is 24.528029441833496 sec
2024-02-17 17:05:06,548 - root - INFO - Train loss: 0.24023057520389557. Valid loss: 0.4321843087673187
2024-02-17 17:05:31,082 - root - INFO - Time taken for epoch 7 is 24.533629417419434 sec
2024-02-17 17:05:31,082 - root - INFO - Train loss: 0.23849350214004517. Valid loss: 0.42771297693252563
2024-02-17 17:05:55,605 - root - INFO - Time taken for epoch 8 is 24.522605419158936 sec
2024-02-17 17:05:55,605 - root - INFO - Train loss: 0.23587775230407715. Valid loss: 0.41402745246887207
2024-02-17 17:06:20,119 - root - INFO - Time taken for epoch 9 is 24.513646602630615 sec
2024-02-17 17:06:20,119 - root - INFO - Train loss: 0.23518583178520203. Valid loss: 0.4122047424316406
2024-02-17 17:06:44,639 - root - INFO - Time taken for epoch 10 is 24.519590854644775 sec
2024-02-17 17:06:44,640 - root - INFO - Train loss: 0.23324529826641083. Valid loss: 0.40348902344703674
2024-02-17 17:07:09,151 - root - INFO - Time taken for epoch 11 is 24.5117027759552 sec
2024-02-17 17:07:09,152 - root - INFO - Train loss: 0.2319081723690033. Valid loss: 0.3999544084072113
2024-02-17 17:07:33,646 - root - INFO - Time taken for epoch 12 is 24.493738174438477 sec
2024-02-17 17:07:33,646 - root - INFO - Train loss: 0.23174363374710083. Valid loss: 0.40031805634498596
2024-02-17 17:07:58,185 - root - INFO - Time taken for epoch 13 is 24.53896474838257 sec
2024-02-17 17:07:58,185 - root - INFO - Train loss: 0.23279695212841034. Valid loss: 0.3989850878715515
2024-02-17 17:08:22,697 - root - INFO - Time taken for epoch 14 is 24.510988235473633 sec
2024-02-17 17:08:22,697 - root - INFO - Train loss: 0.23582108318805695. Valid loss: 0.4043871760368347
2024-02-17 17:08:47,243 - root - INFO - Time taken for epoch 15 is 24.546104192733765 sec
2024-02-17 17:08:47,244 - root - INFO - Train loss: 0.2347545623779297. Valid loss: 0.39817267656326294
2024-02-17 17:09:12,037 - root - INFO - Time taken for epoch 16 is 24.793073177337646 sec
2024-02-17 17:09:12,037 - root - INFO - Train loss: 0.23486466705799103. Valid loss: 0.3947131931781769
2024-02-17 17:09:37,098 - root - INFO - Time taken for epoch 17 is 25.06103777885437 sec
2024-02-17 17:09:37,099 - root - INFO - Train loss: 0.23397977650165558. Valid loss: 0.38533443212509155
